<html>
<head>
<title>memory monitor</title>
</head>

<body>
<div style='height:105px;line-height:105px;overflow:hidden;border:1px'>混合式内存系统实时监控</div>
</br>
</br>
<div id="container1" style="height: 400px; width: 900px;float:left"></div>
<div id="container5" style="height: 400px; width: 900px;float:right"></div>
</br>
</br>

<div id="container2" style="height: 400px; width: 900px;float:left"></div>
<div id="container4" style="height: 400px; width: 900px;float:right"></div>
</br>
</br>


<script src='/static/jquery.js'></script>
<script src='/static/highstock.js'></script>
<script src='/static/exporting.js'></script>
<script src='/static/highcharts.js'></script>
<script src='/static/highcharts-more.js'></script>
<script>
$(function () {
    // 使用当前时区，否则东八区会差八个小时
    Highcharts.setOptions({
        global: {
            useUTC: false
        }
    });
    		
    	 
     $.getJSON('/dram_use', function (dram_use) {

        // Create the chart
        $('#container1').highcharts('StockChart', {
	chart:{
        events:{
            load:function(){
                var series = this.series[0]
                setInterval(function(){
                $.getJSON('/dram_use',function(res){
                    $.each(res,function(i,v){
                        series.addPoint(v)
                    })
                })
                },3000)
            }
        }
        },
            rangeSelector : {
                selected : 1
            	},
            title : {
                text : 'DRAM使用量变化图'
            	},
            series : [{
                name : 'used dram',
                data : dram_use,
                tooltip: {
                    valueDecimals: 2
                }
            	}]
        });
    });

	$.getJSON('/nvm_use', function (nvm_use) {

        // Create the chart
        $('#container2').highcharts('StockChart', {
        chart:{
        events:{
            load:function(){
                var series = this.series[0]
                setInterval(function(){
                $.getJSON('/nvm_use',function(res){
                    $.each(res,function(i,v){
                        series.addPoint(v)
                    })
                })
                },3000)
            }
        }
        },
            rangeSelector : {
                selected : 1
            	},
            title : {
                text : 'NVM使用量变化图'
            	},
            series : [{
                name : 'used nvm',
                data : nvm_use,
                tooltip: {
                    valueDecimals: 2
                }
            	}]
        });
    });

	
	  $('#container3').highcharts({
        chart: {
            plotBackgroundColor: null,
            plotBorderWidth: null,
            plotShadow: false
        },
        title: {
            text: '各种应用所占的NVM量比例'
        },
        tooltip: {
            headerFormat: '{series.name}<br>',
            pointFormat: '{point.name}: <b>{point.percentage:.1f}%</b>'
        },
        plotOptions: {
            pie: {
                allowPointSelect: true,
                cursor: 'pointer',
                dataLabels: {
                    enabled: true,
                    format: '<b>{point.name}</b>: {point.percentage:.1f} %',
                    style: {
                        color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                    }
                }
            }
        },
        series: [{
            type: 'pie',
            name: 'used memory of applications',
            data: [
                ['Firefox',   45.0],
                ['IE',       26.8],
                {
                    name: 'Chrome',
                    y: 12.8,
                    sliced: true,
                    selected: true
                },
                ['Safari',    8.5],
                ['Opera',     6.2],
                ['其他',   0.7]
            ]
        }]
    });
    
    $('#container4').highcharts({
        chart: {
            type: 'pie',
            options3d: {
                enabled: true,
                alpha: 45,
                beta: 0
            }
        },
        title: {
            text: '各种应用所占的DRAM量比例'
        },
        tooltip: {
            pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
        },
        plotOptions: {
            pie: {
                allowPointSelect: true,
                cursor: 'pointer',
                depth: 35,
                dataLabels: {
                    enabled: true,
                    format: '{point.name}'
                }
            }
        },
        series: [{
            type: 'pie',
            name: 'cache percentage',
            data: [
                ['Firefox',   45.0],
                ['IE',       26.8],
                {
                    name: 'Chrome',
                    y: 12.8,
                    sliced: true,
                    selected: true
                },
                ['Safari',    8.5],
                ['Opera',     6.2],
                ['Others',   0.7]
            ]
        }]
    });

    $('#container5').highcharts([
        chart: {
            type: 'column'
        }
        },
        title: {
            text: 'DRAM和NVM的实时变化情况'
        },
        xAxis: {
            type: 'category'
        },
        yAxis: {
            title: {
                text: '使用量'
            }
        },
        legend: {
            enabled: false
        },
        plotOptions: {
            series: {
                borderWidth: 0,
                dataLabels: {
                    enabled: true,
                    format: '{point.y:.1f}%'
                }
            }
        },
        series: [{
            name: 'NVM和DRAM使用量比较',
            colorByPoint: true,
            data: [{
                name: 'DRAM使用量',
                y: 20.3,
            }, {
                name: 'NVM使用量',
                y: 24.03,
            }]
        ]}
     ]);

    

				
});
</script>

</body>
</html>
